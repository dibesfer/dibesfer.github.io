<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ—ºREST Countries</title>
    <script src="/ferscript.js"></script>
    <style>
        * {
            margin: 0;
            box-sizing: border-box;
        }

        body {
            font-family: monospace;
            font-size: 1rem;
            line-height: 2;
        }

        header,
        footer {
            text-align: center;
        }

        #displayer {
            overflow-x: auto;
            overflow-y: hidden;
        }

        #displayerInfo {
            text-align: center;
        }

        .displayer-flex-item {
            display: flex;
            border: solid 1px black;
            height: 100px;
            width: 100%;
            min-width: max-content
        }

        .flagdisplay {
            background-image: radial-gradient(gray, black);

        }

        .flagdisplay>img {
            height: 100%;
            width: 150px;
            object-fit: contain;
            background-image: radial-gradient(gray, black);
        }

        .namedisplay {
            flex: 1;
            height: 100%;
            overflow: auto;
            width: 400px;
            padding-left: 10px;
        }

        .coatdisplay>img {
            height: 100%;
            width: 150px;
            display: block;
            overflow: auto;
            object-fit: contain;
            background-color: rgb(200, 200, 200);

        }
        .percentageShow {
            font-size: smaller;
            color: gray;
        }
    </style>
</head>

<body>
    <header>
        <h1>ðŸ—ºCountries of the World</h1>
        <h3>Ordered by descending population ðŸ‘¥</h3>

    </header>

    <div style="display: flex;justify-content: space-around; height:100px; padding: 10px;">

        <img height="100%" src="https://upload.wikimedia.org/wikipedia/commons/d/d7/Flag-globe-2.gif"
            alt="World Spinning with Flags">

        <img height="100%"
            src="https://upload.wikimedia.org/wikipedia/commons/7/7f/Rotating_earth_animated_transparent.gif"
            alt="Rotating World Globe">
        
        <img height="100%"
            src="https://upload.wikimedia.org/wikipedia/commons/8/8d/Flags_of_the_World_%28WFB_2018%29.gif"
            alt="World Flags">

    </div>

    <div id="displayerInfo">

    </div>

    <div id="displayer">
        <h2>Loading content...</h2>
        <img src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Loading_icon.gif" alt="Loading Spinning Image">
    </div>



    <footer>
        <p>Thanks to https://restcountries.com/#fields-mandatory</p>
    </footer>

    <script>

        let counter = 1

        async function loadCountries() {

            let totalPopulation = 0
            fetch("https://restcountries.com/v3.1/all?fields=name,population,flags,coatOfArms,independent,capital")
                .then(x => x.json())
                .then(y => {
                    y.sort(function (a, b) { return b.population - a.population });

                    displayer.innerHTML = ""

                    for (let i = 0; i < y.length - 1; i++) {
                        const element = y[i];

                        totalPopulation += element.population


                        //console.log(element)

                    }

                    displayerInfo.textContent = "World population: " + thousandDot(totalPopulation)

                    for (let i = 0; i < y.length - 1; i++) {
                        const element = y[i];

                        let percentage = element.population*100/totalPopulation
                        percentage = decimalTwo(percentage)
                        
                        if (percentage >= 0.01){
                            percentage = "<span class='percentageShow'>(" + percentage + "%)</span>"
                        }
                        else {
                            percentage = ""
                        }

                        if (element.population > 0 && element.independent == true) {
                            displayer.innerHTML += `
                        
                        <div class="displayer-flex-item">

                        <div class="flagdisplay">
                        <img src="${element.flags.png}" alt="${element.name.common}'s' flag">
                        </div>

                        <div class="namedisplay">
                        <h2>${counter}. ${element.name.common}, ${thousandDot(element.population)} ${percentage}</h2>
                        <p>${element.name.official}, ${element.capital}</p>
                        </div>
                        
                        <div class="coatdisplay">
                        <img src="${element.coatOfArms.png}" alt="Coat of Arms of ${element.name.common}">
                        </div>
                            

                        </div>

                        `
                            counter++
                        }

                        //console.log(element)

                    }








                    return y
                })
                .then(z => {



                })
        }



        loadCountries()


    </script>
</body>

</html>