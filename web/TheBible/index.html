<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Bible</title>

    <style>
        #displayer > details > summary {
            font-size: larger;
        }
    </style>
</head>



<body>
    <header>
        <h1>The Bible</h1>
        <h3 id="information"></h3>
    </header>
    <main>
        <div id="displayer">

        </div>
    </main>
    <footer>
        <p>by <a href="https://dibesfer.github.io">dibesfer</a> with <a href="https://bible-api.com">bible-api</a> and <a href="https://www.biblesupersearch.com/">biblesupersearch</a></p>
    </footer>
    <script>

        let html = ""
        let bible = {}
        let books = []
        let chapters = []
        let counter = 1
        fetch("asv.json")
            .then(x => x.json())
            .then(y => {
                
                for (let i = 0; i < y.verses.length; i++) {
                    const verse = y.verses[i];
                    const book = verse.book_name;
                    const chapter = verse.chapter;
                    const text = verse.text;
                    console.log(book)
                    if (!bible[book]){
                        bible[book] = {}
                    }
                    if (!bible[book][chapter]){
                        bible[book][chapter] = []
                    }
                    bible[book][chapter].push(text)
                }

                for (const key in bible) {
                                        
                    const element = bible[key];
                    html += `<details><summary>${counter++}. ${key}</summary>`;

                    for (const key2 in bible[key]){
                        html += `
                        
                        <details><summary>Chapter ${key2}</summary>

                        `

                        for (let i = 0; i < bible[key][key2].length; i++) {
                            const element = bible[key][key2][i];

                            html += "<p>" + element + "</p>"

                            
                        }

                        html += "</details>"

                    }
                    
                    html += "</details>"
                    
                    
                }
                displayer.innerHTML = html
            
                information.textContent = `is a compendium of ${Object.keys(bible).length} books, according to Protestantism` 
            });


//         fetch("https://bible-api.com/data/web")
//             .then(res => res.json())
//             .then(async y => {
//                 let books = y.books;
//                 information.textContent = "is a compendium of " + books.length + " books.";

//                 for (let i = 0; i < books.length; i++) {
//                     const book = books[i];
//                     displayer.innerHTML += `<details><summary>${i + 1}. ${book.name}</summary>`;

//                     await getChapters(book.id); // âœ… pasamos solo el id

//                     displayer.innerHTML += "</details>";
//                 }
//             });

//         async function getChapters(id) {
//             const link = `https://bible-api.com/data/web/${id}`;
//             console.log(link);

//             const x = await fetch(link);
//             const y = await x.json();

//             displayer.innerHTML += `Chapters: ${y.chapters.length}`;
//             await sleep(1000);
//         }

//         function sleep(ms) {
//   return new Promise(resolve => setTimeout(resolve, ms));
// }
    </script>
</body>

</html>