<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AJAX</title>
    <style>
        #demo {
            white-space: pre-wrap;
            max-width: 100%;
            background-color: aliceblue;
        }
    </style>
</head>

<body>
    <h1>AJAX</h1>
    <h3>Asynchronous Javascript And XML</h3>
    <div id="demo"></div>
    <script>
        // setTimeout(()=>document.write(1 + " frase</br>"),6000)
        // setTimeout(()=>document.write(2 + " frase</br>"),2000)
        // setTimeout(()=>document.write(3 + " frase</br>"),4000)
        // setTimeout(()=>document.write(4 + " frase</br>"),1000)
    </script>
    <script>
        let demo = document.getElementById("demo")
        let mySuperString = ""

        // function prometer(){
        //     return new Promise(
        //         (resolver, rechazar) => {
        //                             }
        //     )
        // }
        
        // prometer().then(
        //     resultado => document.write(resultado)
        // ).catch()

        // prometer().then(
        //     resultado => document.write(resultado)
        // ).catch()
        let arrMS = []
        let ms = Math.random()*10000;
        document.write("<h1>Title</h1>")
        let contador = 0
        
        function myFunc(ejemplo, myms){
            demo.innerHTML+=("Ranking " + contador + ".- hello " + ejemplo + " " + arrMS[ejemplo] + " secs. <br>")
            contador++
        }

        for (let i = 0; i < 100; i++) {
            ms = Math.random()*10000;
            
            arrMS.push((ms/1000).toFixed(2))
            setTimeout(function() {myFunc(i,ms)},ms)
            
        }
    

        

        const promesa = new Promise(
            (resolve, reject) => {

                const exito = true

                console.log(new Date() + "<br>")
                for (let i = 0; i < 17000000; i++) {
                    mySuperString += "/@/"
                }
                console.log(mySuperString.length)

                if (exito) {
                    resolve("TODO VA BIEN")
                }
                else {
                    reject("TODO VA MAL")
                }
            }
        )

        promesa.then(resultado => {
            document.write("Todo OK: Resultado" + resultado + "<br>")
            console.log("Todo OK: Resultado" + resultado)
            //demo.textContent = mySuperString
            //demo.textContent = ""
            console.log(new Date() + "<br>")
        }).catch(error => {
            document.write("Todo KO: Resultado" + resultado + "<br>")
            console.log("Todo KO: Resultado" + resultado)

        })
        console.log("MENSAJE")
        console.log("MENSAJE2")
        console.log("MENSAJE3")
        console.log("MENSAJE4")

        // fetch("https://jsonplaceholder.typicode.com/")
        // .then(respuesta => respuesta.text())
        // .then(html => document.write(html))

        const promesaConstante = fetch("https://jsonplaceholder.typicode.com/posts")
        
        //console.log(promesaConstante)

        // promesaConstante.then(resultado => resultado.json())
        // .then(json => {
        //     demo.style.wordWrap = "pre"
        //     demo.textContent = JSON.stringify(json, null, "\t")
        // })
        
        //console.log(promesaConstante)

        const misuperpromesa = fetch("https://dibesfer.com/")

        misuperpromesa
        .then(respuesta => respuesta.text())
        .then(texto => {
        let mystring = "<details><summary>dibesfer.com</summary><div id='francotirador'></div> </details>"
        
        demo.innerHTML += mystring
        let francotirador = document.getElementById("francotirador")
        francotirador.textContent += texto.trim()
    
        })

        const pokefetch = fetch("https://pokeapi.co/api/v2/pokemon?limit=-1")

        pokefetch
        .then(resultado => resultado.text())
        .then(texto => {
            demo.innerHTML += `
        <details><summary>PokeApi</summary>${texto}</details>
        `
        })
    </script> 
</body>

</html>